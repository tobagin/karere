<?xml version="1.0"?>
<!DOCTYPE fontconfig SYSTEM "fonts.dtd">
<fontconfig>
  <!-- Load the default system configuration -->
  <include>/etc/fonts/fonts.conf</include>

  <!-- Explicitly add our bundled fonts directory -->
  <dir>/app/share/fonts</dir>

  <!-- Reject the host's Noto-COLRv1 if present, as it seems to cause partial rendering issues -->
  <selectfont>
    <rejectfont>
        <glob>/run/host/fonts/google-noto-color-emoji-fonts/Noto-COLRv1.ttf</glob>
    </rejectfont>
    <!-- Just in case it's mounted elsewhere or named differently but still COLRv1 matches -->
    <rejectfont>
       <pattern>
         <patelt name="file"><string>Noto-COLRv1.ttf</string></patelt>
       </pattern>
    </rejectfont>
  </selectfont>

  <!-- Prioritize our bundled Noto Color Emoji -->
  <alias>
    <family>emoji</family>
    <prefer>
      <family>Noto Color Emoji</family>
    </prefer>
  </alias>

  <!-- Add as fallback for standard families, prepended to ensure B&W symbols don't take precedence -->
  <alias>
    <family>sans-serif</family>
    <prefer>
      <family>Noto Color Emoji</family>
    </prefer>
  </alias>
  <alias>
    <family>serif</family>
    <prefer>
      <family>Noto Color Emoji</family>
    </prefer>
  </alias>
  <alias>
    <family>monospace</family>
    <prefer>
      <family>Noto Color Emoji</family>
    </prefer>
  </alias>

  <!-- Alias common web emoji fonts to Noto Color Emoji -->
  <alias>
    <family>Segoe UI Emoji</family>
    <prefer><family>Noto Color Emoji</family></prefer>
  </alias>
  <alias>
    <family>Apple Color Emoji</family>
    <prefer><family>Noto Color Emoji</family></prefer>
  </alias>
  <alias>
    <family>Android Emoji</family>
    <prefer><family>Noto Color Emoji</family></prefer>
  </alias>
  <alias>
    <family>Twitter Color Emoji</family>
    <prefer><family>Noto Color Emoji</family></prefer>
  </alias>
  <alias>
    <family>Color Emoji</family>
    <prefer><family>Noto Color Emoji</family></prefer>
  </alias>
</fontconfig>
